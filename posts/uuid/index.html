<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>You don&#39;t need UUID | Henrique Vicente</title>
    <link href="https://fonts.googleapis.com/css?family=Raleway|Fira+Code|Comfortaa:300" rel="stylesheet">
    <link rel="stylesheet" href="/css/foundation-icons.css">
    <link rel="stylesheet" href="/css/foundation.min.css">
    <link rel="stylesheet" href="/webicons/webicons.css">
    <link rel="stylesheet" href="/css/syntax.css">
    <link rel="stylesheet" href="/css/henvic.css">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta property="og:title" content="You don&#39;t need UUID | Henrique Vicente">
    <meta name="twitter:title" content="You don&#39;t need UUID | Henrique Vicente" />
    <meta property="og:url" content="https://henvic.dev/posts/uuid/">
    
    <meta name="description" content="I&#39;ve experienced first-hand how using UUID hurts the usability of computer systems, and I want you to understand why you certainly don&#39;t need it.">
    <meta property="og:description" content="I&#39;ve experienced first-hand how using UUID hurts the usability of computer systems, and I want you to understand why you certainly don&#39;t need it.">
    <meta name="twitter:description" content="I&#39;ve experienced first-hand how using UUID hurts the usability of computer systems, and I want you to understand why you certainly don&#39;t need it." />
    
    
    <meta property="og:type" content="article">
    <meta property="article:published_time" content="2021-05-30">
    
    <meta property="twitter:url" content="https://henvic.dev/posts/uuid/">
    
    <meta name="og:image" content="https://henvic.dev/img/posts/uuid/matrix.png" />
    <meta name="twitter:image" content="https://henvic.dev/img/posts/uuid/matrix.png" />
    
</head>
<body><div class="grid-y medium-grid-frame">
        <nav class="title-bar show-for-small-only" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button class="menu-icon" type="button" data-toggle="responsive-menu"></button>
    <div class="title-bar-title invisible">Menu</div>
</nav>
<nav class="top-bar" id="responsive-menu">
    <div class="top-bar-right no-js">
        <ul class="dropdown menu vertical medium-horizontal large-horizontal" data-active-class="active" data-hover-delay="150" data-closing-time="80" data-alignment="left"
            data-dropdown-menu data-smooth-scroll>
            
            
            
            
            
                <li class=" ">
                    <a href="/" >
                        Home
                    </a>
                </li>
            
            
            
            
            
            
                <li class=" ">
                    <a href="/posts/" >
                        Blog posts
                    </a>
                </li>
            
            
            
            
            
            
                <li class=" ">
                    <a href="/talks/" >
                        Talks
                    </a>
                </li>
            
            
            
            
            
            
                <li class="show-for-small-only ">
                    <a href="/portfolio/" >
                        Portfolio
                    </a>
                </li>
            
            
                <li class="hide-for-small-only is-dropdown-submenu-parent ">
                    <a href="/portfolio/" >
                        Portfolio
                    </a>
                <ul class="vertical menu nested submenu">
                    
                    
                    <li >
                        <a href="/portfolio/#httpretty" title="httpretty">
                            httpretty
                        </a>
                    </li>
                    
                    
                    <li >
                        <a href="/portfolio/#wedeploy" title="WeDeploy CLI Tool">
                            WeDeploy CLI Tool
                        </a>
                    </li>
                    
                    
                    <li >
                        <a href="/portfolio/#vehikel" title="Vehikel">
                            Vehikel
                        </a>
                    </li>
                    
                    
                    <li >
                        <a href="/portfolio/#tic-tac-toe" title="Tic-tac-toe">
                            Tic-tac-toe
                        </a>
                    </li>
                    
                    
                    <li >
                        <a href="/portfolio/#accidents" title="accidents">
                            accidents
                        </a>
                    </li>
                    
                    
                    <li >
                        <a href="/portfolio/#topostit" title="to-post.it">
                            to-post.it
                        </a>
                    </li>
                    
                    
                    <li >
                        <a href="/portfolio/#trazqueeupago" title="trazqueeupago.com">
                            trazqueeupago.com
                        </a>
                    </li>
                    
                    
                    <li >
                        <a href="/portfolio/#cahier" title="Cahier">
                            Cahier
                        </a>
                    </li>
                    
                    
                    <li >
                        <a href="/portfolio/#plifk" title="Plifk">
                            Plifk
                        </a>
                    </li>
                    
                </ul>
                </li>
            
            
            
            
            
                <li class=" ">
                    <a href="/opensource/" >
                        Open Source
                    </a>
                </li>
            
            
            
            
            
            
                <li class=" ">
                    <a href="/favorites/" >
                        Favorites
                    </a>
                </li>
            
            
            
            
            
            
                <li class=" ">
                    <a href="/about/" >
                        About me
                    </a>
                </li>
            
            
            
            
            
            
            
            
            <li><a href="/resume.pdf" class="button-resume">Résumé</a></li>
        </ul>
    </div>
</nav>

        <div class="cell medium-auto medium-cell-block-container">
            <div class="grid-x grid-padding-x">
                <div class="nav cell large-3 medium-4 large-cell-block-y medium-cell-block-y"><div itemscope itemtype="http://schema.org/Person">
    <div class="nav-card grid-x">
        <div class="cell small-2 medium-12 nav-card-photo-cell">
            <a href="/" itemprop="photo" class="nav-card-photo">
                <img src="/img/me_at_gullfoss_cropped.jpg" alt="me at Gullfoss" width="549" height="549" />
            </a>
        </div>
        <div class="cell card-section small-10 medium-12 medium-text-center">
            <h4 itemprop="name">Henrique Vicente</h4>
            <p>
                <span itemprop="title">Software Engineer</span>
            </p>
        </div>
    </div>
    <ul class="nav-about-me no-bullet">
        
        <li>
            <p>I'm a Senior Software Engineer at <a href="https://www.zenrows.com/">ZenRows</a> working with web scraping technology. I was born in Brazil and live in The&nbsp;Hague,&nbsp;Netherlands.<br /><br />
                I enjoy photography, drones, and traveling.</p>
        </li>
        
        <li>
            <a href="https://keybase.io/henvic" class="fingerprint" title="Keybase profile">D0F4<span
                    class="space"></span>DFBD<span class="space"></span>257C<span class="space"></span>1575</a>
        </li>
    </ul>
    <div class="menu-social">
        <a class="webicon github" href="https://github.com/henvic">
            GitHub
        </a>
        <a class="webicon twitter" href="https://twitter.com/henriquev">
            Twitter
        </a>
        <a class="webicon linkedin" href="https://www.linkedin.com/in/henvic">
            Linkedin
        </a>
        <a class="webicon instagram" href="https://www.instagram.com/henvic/">
            Instagram
        </a>
        <a class="webicon flickr" href="https://www.flickr.com/photos/henriquev/">
            Flickr
        </a>
        <a class="webicon mail" href="mailto:henriquevicente@gmail.com" itemprop="email">
            henriquevicente@gmail.com
        </a>
    </div>
    
</div>
</div>

<article class="cell large-9 medium-8 large-cell-block-y medium-cell-block-y main">
        <h1 class="post-title">You don&#39;t need UUID</h1>
        
        
        <p class="post-date"><time class="stat" datetime="2021-05-30 00:00:00 &#43;0000 UTC"></time>Sunday, 30 May 2021</time>.</p>
        
        <p><a href="https://en.wikipedia.org/wiki/Universally_unique_identifier">UUID</a>, short for Universally Unique Identifier (<a href="https://www.rfc-editor.org/info/rfc4122">spec</a>), is a 128-bit identifier format widespread on computer systems.
The following is an example, using its prevalent representation: <samp>a73ba12d-1d8b-2516-3aee-4b15e563a835</samp>.
I&rsquo;ve experienced first-hand how using UUID hurts the usability of computer systems, and I want you to understand why you certainly don&rsquo;t need it.</p>
<p>Take Amazon. Which do you think is a link to one of their products?</p>
<ul>
<li><a href="https://amzn.to/3c6n63N">amzn.to/3c6n63N</a></li>
<li>amzn.to/a73ba12d-1d8b-2516-3aee-4b15e563a835</li>
</ul>
<p>A simple ID like <samp>3c6n63N</samp> is more than enough to represent any product while keeping it readable and making communication easier.
A UUID alternative like <samp>a73ba12d-1d8b-2516-3aee-4b15e563a835</samp> is just wasteful from an user&rsquo;s perspective.</p>
<p>In a specific case, I’ve witnessed entities that were supposed to be exposed to end-users using user-friendly ids while UUIDs were in use internally.
For this to work, either a one-to-one mapping or a separate list of unique ids for your entities are necessary.</p>
<blockquote>
<p>You might as well end up with a combination of the worst of both worlds: UUID + sequentially generated (auto increment) numeric identifiers.</p>
</blockquote>
<p>I’ve seen all sorts of combinations of this on many systems: some entities using only friendly ids, some using only sequential ids, and most using both.</p>
<p>For example, an entity that is used only internally might be using a UUID.
Then a demand to expose it externally appears, and developers add a new friendly ID so that users won&rsquo;t deal with ridiculously long links.</p>
<ul>
<li>When using UUID, it&rsquo;s hard to use, track, and compare data manually.</li>
<li>When using sequential ids, you might be leaking sensitive business metrics to the competition or hit scalability and syncing limits.</li>
<li>When using both at the same time, your internal users might have a hard time mapping ids to UUIDs and vice-versa.</li>
</ul>
<p>So, with all this said, I think I&rsquo;ve made a case for trying to just stick to more accessible ids everywhere!
Next, watch this video, and let&rsquo;s see a practical alternative.</p>
<div class="grid-x">
        <div class="medium-6 small-12">
                
                <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
                  <iframe src="https://www.youtube.com/embed/gocwRvLhDf8" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
                </div>

                <p><small>
                <a href="https://www.youtube.com/watch?v=gocwRvLhDf8">Will YouTube Ever Run Out Of Video IDs?</a> by <a href="https://www.tomscott.com/">Tom Scott</a>
                </small></p>
        </div>
</div>
<h2 id="collisions-and-uniqueness">Collisions and uniqueness</h2>
<p>The UUID textual representation is 36 characters long, being four hyphen separators and 32 hexadecimal digits.
There are four versions.
Version 1 and 2 were date-time and MAC address-based.
Version 3 and 5 are namespace name-based.
Version 4 is completely randomly generated (hence, it has more entropy) and is what most web systems seem to use.</p>
<p>It has 16^32 = 2^128 bits that guarantee uniqueness and has an insignificant risk of collision.</p>
<blockquote>
<p>Hexadecimal is commonly used in computing as a compact representation for the binary numeral system.
In hexadecimal, 10 is 0xA, 11 is 0xB, 12 is 0xC, 13 is 0xD, 14 is 0xE, 15 is 0xF, 16 is 0x10, and so on.
Read <a href="https://en.wikipedia.org/wiki/Binary_number#Conversion_to_and_from_other_numeral_systems">Binary number: conversion to and from other numeral systems</a> if you want to learn or review how it works.</p>
</blockquote>
<h2 id="practical-solutions">Practical solutions</h2>
<p>As Tom Scott shows in his video, 11 base58-encoded characters are enough for YouTube to serve content even when considering that unlisted videos should be undiscoverable.</p>
<p>Let&rsquo;s see what a simple and elegant solution for generating that in Go might be:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// NewID generates a random base-58 ID.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">NewID</span>() <span style="color:#66d9ef">string</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> (
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">alphabet</span> = <span style="color:#e6db74">&#34;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&#34;</span> <span style="color:#75715e">// base58
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		<span style="color:#a6e22e">size</span>     = <span style="color:#ae81ff">11</span>
</span></span><span style="display:flex;"><span>	)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">id</span> = make([]<span style="color:#66d9ef">byte</span>, <span style="color:#a6e22e">size</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">rand</span>.<span style="color:#a6e22e">Read</span>(<span style="color:#a6e22e">id</span>); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>		panic(<span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span>, <span style="color:#a6e22e">p</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">id</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">id</span>[<span style="color:#a6e22e">i</span>] = <span style="color:#a6e22e">alphabet</span>[int(<span style="color:#a6e22e">p</span>)<span style="color:#f92672">%</span>len(<span style="color:#a6e22e">alphabet</span>)] <span style="color:#75715e">// discard everything but the least significant bits
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> string(<span style="color:#a6e22e">id</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p><a href="https://play.golang.org/p/T3wvtUNSJcy" lang="en-US" class="button secondary">Play with this code</a></p>
<p>This solution uses the human-readable <a href="https://tools.ietf.org/id/draft-msporny-base58-01.html">base58 encoding scheme</a>.
I cheated a little by using only the least significant bits to create the ID instead of trying to squeeze performance as this is good enough.</p>
<p>There are other possibilities. Base58 is just one option. You might have different needs, for example:</p>
<ul>
<li>Using only lowercase to avoid ambiguity</li>
<li>Limiting the number of chars combinations to avoid words (naughty words) coming out as identifiers</li>
</ul>
<p>You just need to do some basic math to make sure you&rsquo;ve something solid for your use case.</p>
<h3 id="when-to-use-uuid">When to use UUID?</h3>
<p>UUID was designed thinking about distributed systems, but not all distributed systems are equal.
If you&rsquo;re talking about a web system composed of microservice architecture all running on the same datacenter, perhaps sharing the same database, I&rsquo;d say it&rsquo;s implausible that you need UUIDs at all, even if you&rsquo;re running things at scale.</p>
<p>On the other hand, if you&rsquo;re ingesting data generated by systems out of your control, it might be a good choice.
I&rsquo;ve used it when writing a metrics and diagnostics system for CLI tools (<a href="https://github.com/henvic/climetrics">climetrics</a>).
In this specific case, the CLI tool I maintained appended entries to a file flushed to our servers through a background process executed eventually following some heuristics.</p>
<p>Thank you for reading this article.</p>
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">You don&#39;t need UUID <a href="https://t.co/pXgAQiy62t">https://t.co/pXgAQiy62t</a></p>&mdash; Henrique Vicente (@henriquev) <a href="https://twitter.com/henriquev/status/1399330361126031363?ref_src=twsrc%5Etfw">May 31, 2021</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<script type="text/javascript">
amzn_assoc_tracking_id = "henvic-20";
amzn_assoc_ad_mode = "manual";
amzn_assoc_ad_type = "smart";
amzn_assoc_marketplace = "amazon";
amzn_assoc_region = "US";
amzn_assoc_design = "enhanced_links";
amzn_assoc_asins = "0984782850";
amzn_assoc_placement = "adunit";
amzn_assoc_linkid = "65cdf509fe5c5bb4f9b616660057129c";
</script>
<script src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US"></script>
<p><small>If you click and buy any of these from Amazon after visiting the links above, I might get a commission from their <a href="https://affiliate-program.amazon.com/">Affiliate program</a>.</small></p>

                <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-size="large"
                        data-text="You don&#39;t need UUID" data-url="https://henvic.dev/posts/uuid/" data-via="henriquev"
                        data-hashtags="programming"  data-show-count="false">Tweet</a>
                        <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
        <aside class="read-also">
                <h3>Read also</h3>
                <ul>
                        <li>
                                <a href="/posts/tesla/">My new Tesla Model Y 2023</a>
                                <time datetime="2006-01-02">Wednesday 11, January 2023</time>
                        </li><li>
                                <a href="/posts/go-utf8/">UTF-8 strings with Go: len(s) isn&#39;t enough</a>
                                <time datetime="2006-01-02">Monday 7, March 2022</time>
                        </li><li>
                                <a href="/posts/go-postgres/">Back to basics: Writing an application using Go and PostgreSQL</a>
                                <time datetime="2006-01-02">Monday 22, November 2021</time>
                        </li><li>
                                <a href="/posts/postgres-14-freebsd-13/">Upgrading to PostgreSQL 14 on FreeBSD 13</a>
                                <time datetime="2006-01-02">Thursday 11, November 2021</time>
                        </li><li>
                                <a href="/posts/go/">The ecosystem of the Go programming language</a>
                                <time datetime="2006-01-02">Monday 22, March 2021</time>
                        </li><li>
                                <a href="/posts/my-go-mistakes/">My Go mistakes</a>
                                <time datetime="2006-01-02">Thursday 18, February 2021</time>
                        </li><li>
                                <a href="/posts/env/">Environment variables, config, secrets, and globals</a>
                                <time datetime="2006-01-02">Saturday 16, January 2021</time>
                        </li><li>
                                <a href="/posts/signal-notify-context/">signal.NotifyContext: handling cancelation with Unix signals using context</a>
                                <time datetime="2006-01-02">Wednesday 16, September 2020</time>
                        </li><li>
                                <a href="/posts/e-commerce/">I&#39;m starting an opensource e-commerce project.</a>
                                <time datetime="2006-01-02">Wednesday 17, June 2020</time>
                        </li><li>
                                <a href="/posts/cs-security/">Counter-Strike code leaked: should you worry? What if your code leaks? Learn how to deliver software securely.</a>
                                <time datetime="2006-01-02">Wednesday 22, April 2020</time>
                        </li>
                </ul>
        </aside>
</article>

            </div>
        </div>
    </div>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-43519325-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script src="/js/vendor/modernizr-custom-svg.js"></script>
<script src="/js/vendor/what-input.js"></script>
<script src="/js/vendor/jquery.min.js"></script>
<script src="/js/vendor/foundation.min.js"></script>
<script>
        $(document).ready(function () {
                $(document).foundation();
        });
</script>
</body>
</html>
