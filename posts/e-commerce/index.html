<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>I&#39;m starting an opensource e-commerce project. | Henrique Vicente</title>
    <link href="https://fonts.googleapis.com/css?family=Raleway|Fira+Code|Comfortaa:300" rel="stylesheet">
    <link rel="stylesheet" href="/css/foundation-icons.css">
    <link rel="stylesheet" href="/css/foundation.min.css">
    <link rel="stylesheet" href="/webicons/webicons.css">
    <link rel="stylesheet" href="/css/syntax.css">
    <link rel="stylesheet" href="/css/henvic.css">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta property="og:title" content="I&#39;m starting an opensource e-commerce project. | Henrique Vicente">
    <meta name="twitter:title" content="I&#39;m starting an opensource e-commerce project. | Henrique Vicente" />
    <meta property="og:url" content="https://henvic.dev/posts/e-commerce/">
    
    <meta name="description" content="I&#39;m starting an opensource e-commerce project.">
    <meta property="og:description" content="I&#39;m starting an opensource e-commerce project.">
    <meta name="twitter:description" content="I&#39;m starting an opensource e-commerce project." />
    
    
    <meta property="og:type" content="article">
    <meta property="article:published_time" content="2020-06-17">
    
    <meta property="twitter:url" content="https://henvic.dev/posts/e-commerce/">
    
    <meta name="og:image" content="https://henvic.dev/img/posts/e-commerce/market-product-page.png" />
    <meta name="twitter:image" content="https://henvic.dev/img/posts/e-commerce/market-product-page.png" />
    
</head>
<body><div class="grid-y medium-grid-frame">
        <nav class="title-bar show-for-small-only" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button class="menu-icon" type="button" data-toggle="responsive-menu"></button>
    <div class="title-bar-title invisible">Menu</div>
</nav>
<nav class="top-bar" id="responsive-menu">
    <div class="top-bar-right no-js">
        <ul class="dropdown menu vertical medium-horizontal large-horizontal" data-active-class="active" data-hover-delay="150" data-closing-time="80" data-alignment="left"
            data-dropdown-menu data-smooth-scroll>
            
            
            
            
            
                <li class=" ">
                    <a href="/" >
                        Home
                    </a>
                </li>
            
            
            
            
            
            
                <li class=" ">
                    <a href="/posts/" >
                        Blog posts
                    </a>
                </li>
            
            
            
            
            
            
                <li class=" ">
                    <a href="/talks/" >
                        Talks
                    </a>
                </li>
            
            
            
            
            
            
                <li class="show-for-small-only ">
                    <a href="/portfolio/" >
                        Portfolio
                    </a>
                </li>
            
            
                <li class="hide-for-small-only is-dropdown-submenu-parent ">
                    <a href="/portfolio/" >
                        Portfolio
                    </a>
                <ul class="vertical menu nested submenu">
                    
                    
                    <li >
                        <a href="/portfolio/#httpretty" title="httpretty">
                            httpretty
                        </a>
                    </li>
                    
                    
                    <li >
                        <a href="/portfolio/#wedeploy" title="WeDeploy CLI Tool">
                            WeDeploy CLI Tool
                        </a>
                    </li>
                    
                    
                    <li >
                        <a href="/portfolio/#vehikel" title="Vehikel">
                            Vehikel
                        </a>
                    </li>
                    
                    
                    <li >
                        <a href="/portfolio/#tic-tac-toe" title="Tic-tac-toe">
                            Tic-tac-toe
                        </a>
                    </li>
                    
                    
                    <li >
                        <a href="/portfolio/#accidents" title="accidents">
                            accidents
                        </a>
                    </li>
                    
                    
                    <li >
                        <a href="/portfolio/#topostit" title="to-post.it">
                            to-post.it
                        </a>
                    </li>
                    
                    
                    <li >
                        <a href="/portfolio/#trazqueeupago" title="trazqueeupago.com">
                            trazqueeupago.com
                        </a>
                    </li>
                    
                    
                    <li >
                        <a href="/portfolio/#cahier" title="Cahier">
                            Cahier
                        </a>
                    </li>
                    
                    
                    <li >
                        <a href="/portfolio/#plifk" title="Plifk">
                            Plifk
                        </a>
                    </li>
                    
                </ul>
                </li>
            
            
            
            
            
                <li class=" ">
                    <a href="/opensource/" >
                        Open Source
                    </a>
                </li>
            
            
            
            
            
            
                <li class=" ">
                    <a href="/favorites/" >
                        Favorites
                    </a>
                </li>
            
            
            
            
            
            
                <li class=" ">
                    <a href="/about/" >
                        About me
                    </a>
                </li>
            
            
            
            
            
            
            
            
            <li><a href="/resume.pdf" class="button-resume">Résumé</a></li>
        </ul>
    </div>
</nav>

        <div class="cell medium-auto medium-cell-block-container">
            <div class="grid-x grid-padding-x">
                <div class="nav cell large-3 medium-4 large-cell-block-y medium-cell-block-y"><div itemscope itemtype="http://schema.org/Person">
    <div class="nav-card grid-x">
        <div class="cell small-2 medium-12 nav-card-photo-cell">
            <a href="/" itemprop="photo" class="nav-card-photo">
                <img src="/img/me_at_gullfoss_cropped.jpg" alt="me at Gullfoss" width="549" height="549" />
            </a>
        </div>
        <div class="cell card-section small-10 medium-12 medium-text-center">
            <h4 itemprop="name">Henrique Vicente</h4>
            <p>
                <span itemprop="title">Software Engineer</span>
            </p>
        </div>
    </div>
    <ul class="nav-about-me no-bullet">
        
        <li>
            <p>I'm a Senior Software Engineer at <a href="https://www.zenrows.com/">ZenRows</a> working with web scraping technology. I was born in Brazil and live in The&nbsp;Hague,&nbsp;Netherlands.<br /><br />
                I enjoy photography, drones, and traveling.</p>
        </li>
        
        <li>
            <a href="https://keybase.io/henvic" class="fingerprint" title="Keybase profile">D0F4<span
                    class="space"></span>DFBD<span class="space"></span>257C<span class="space"></span>1575</a>
        </li>
    </ul>
    <div class="menu-social">
        <a class="webicon github" href="https://github.com/henvic">
            GitHub
        </a>
        <a class="webicon twitter" href="https://twitter.com/henriquev">
            Twitter
        </a>
        <a class="webicon linkedin" href="https://www.linkedin.com/in/henvic">
            Linkedin
        </a>
        <a class="webicon instagram" href="https://www.instagram.com/henvic/">
            Instagram
        </a>
        <a class="webicon flickr" href="https://www.flickr.com/photos/henriquev/">
            Flickr
        </a>
        <a class="webicon mail" href="mailto:henriquevicente@gmail.com" itemprop="email">
            henriquevicente@gmail.com
        </a>
    </div>
    
</div>
</div>

<article class="cell large-9 medium-8 large-cell-block-y medium-cell-block-y main">
        <h1 class="post-title">I&#39;m starting an opensource e-commerce project.</h1>
        
        
        <p class="post-date"><time class="stat" datetime="2020-06-17 00:00:00 &#43;0000 UTC"></time>Wednesday, 17 June 2020</time>.</p>
        
        <ol>
<li>Most e-commerce platforms operate in a way that makes stores relying on them hostage due to <a href="https://en.wikipedia.org/wiki/Vendor_lock-in">vendor lock-in</a> models.</li>
<li>E-commerce is something that can get complex fast. Search engine optimization (SEO), inventory management, order status, and user experience are essential and can get hard quickly. Especially when in light of the danger of trying to make everything customizable.</li>
<li>Substantial transaction fees drive away businesses operating on tight profit margins.</li>
</ol>
<p><a href="https://github.com/henvic/market">market</a> is an opensource e-commerce software dedicated to the public domain to help small and medium businesses to establish their online presence with a high-quality website without gotchas.</p>
<p><a href="/img/posts/e-commerce/market-product-page.png"><img src="/img/posts/e-commerce/market-product-page_small.png" alt="market product page" width="600"></a></p>
<h2 id="architecture">Architecture</h2>
<p>market has a core application (read: monolith) that handles all requests to its API and regular web pages - both served by separate hosts.
Requests received via <code>www.</code> are handled by the web pages HTTP handlers. The API HTTP endpoints handle requests received via <code>api.</code></p>
<p><a href="https://golang.org/">Go</a> has been my language of choice for years, and it is perfect for this kind of project thanks to its simplicity and straight-forward &rsquo;no magic&rsquo; approach to software engineering.</p>
<p>For the frontend of the application, I am going to rely on <a href="https://reactjs.org/">React</a> and, to be on the safe side of types, I am going to be using <a href="https://www.typescriptlang.org/">TypeScript</a>. Having had a long pause from frontend development, I still don&rsquo;t know how well these two play together, but I am not worried too much.</p>
<table class="stack">
        <caption>External services</caption>
        <tr>
                <td>PostgreSQL</td>
                <td>Relational database to store everything safely.</td>
        </tr>
        <tr>
                <td>ElasticSearch</td>
                <td>Search engine for the search, autocompletion, and category browsing.</td>
        </tr>
        <tr>
                <td>imaginary (or thumbor)</td>
                <td>Photo thumbnail service for resizing images for distribution.</td>
        </tr>
        <tr>
                <td>MinIO / AWS S3 API</td>
                <td>Object storage service compatible with Amazon S3 API.</td>
        </tr>
</table>
<h3 id="databases">Databases</h3>
<p><a href="https://www.postgresql.org/">PostgreSQL</a> is a trustworthy ACID-compliant relational database, probably the best choice for this kind of project.
My knowledge regarding databases is limited, but I know this is the right choice. I recommend you read <a href="https://medium.com/@rakyll/things-i-wished-more-developers-knew-about-databases-2d0178464f78">Things I Wished More Developers Knew About Databases</a> by <a href="https://twitter.com/rakyll">Jaana Dogan</a> if you are interested in databases.</p>
<p>Keeping track of changes is valuable for an online store. However, unfortunately, PostgreSQL, as most relational databases, does not provide versioning natively. We can use a table for storing logs of changes. I could probably look into using something like a <a href="https://en.wikipedia.org/wiki/Merkle_tree">Merkle tree</a> and something more complex to store a register, but it would be hard and have its problems (example: should purging unwanted data be possible?), so this seems like a good enough trade-off.</p>
<h3 id="search">Search</h3>
<p>ElasticSearch has excellent search features such as faceted filters, and I am going to take advantage of it. The inventory should be synced from PostgreSQL to ElasticSearch somehow. I am not sure yet what would be the best approach for this today. Perhaps using a PostgreSQL extension to automate this is the best option.</p>
<p>About seven years ago, I was working on a marketplace for used vehicles and achieved eventual consistency with a best-effort synchronization strategy:</p>
<ul>
<li>On updates, a message would be sent to a background worker to reindex the altered document.</li>
<li>An additional crontab would run regularly to fix any consistency issues.</li>
</ul>
<div class="grid-x">
        <div class="medium-6 small-12">
                
                <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
                  <iframe src="https://www.youtube.com/embed/dML0FQIUcTY" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
                </div>

        </div>
</div>
<h3 id="photo-thumbnail-service">Photo thumbnail service</h3>
<p>I had a great experience with <a href="https://github.com/thumbor/thumbor">thumbor</a> in the past, and I believe it&rsquo;s the most battle-tested thumbnail service out there.</p>
<p>I&rsquo;m giving <a href="https://github.com/h2non/imaginary">imaginary</a> a try for this, though, because it is a Go project, and I&rsquo;d love to see how well it does.</p>
<p><em>The first program I wrote with Go was a photo thumbnail service, too: <a href="https://github.com/henvic/picel">picel</a>.</em></p>
<p>Images files are stored in the storage service and served through the photo thumbnail service where resizing and optimization should happen. Caching might happen either at this layer or in the load-balancer layer (more likely).</p>
<h3 id="compatibility-guarantee">Compatibility guarantee</h3>
<p>Releases will follow <a href="https://semver.org/">Semantic versioning</a>. I intend new versions to be backward compatible unless there exists an excellent reason why not to.
Hopefully, version 1 is going to have a long run. A critical aspect of this is dealing with data structures wisely.</p>
<p>This guarantee assumes no modifications were made to the software, in any case. While this software is intended to be easy to read, and easy to contribute to, it is not intended to be fully customized, but used as-is. Some general guidelines about customization should be written about this later on. Contributions respecting this goal are always welcome.</p>
<h2 id="usage">Usage</h2>
<p>Ideally, a grocery store or car shop could:</p>
<ol>
<li>Buy a domain;</li>
<li>Create an account on a cloud computing platform;</li>
<li>Point his DNS to the Software-as-a-Service provider;</li>
<li>Deploy a free market appliance and have a store up and running in minutes with HTTPS and everything else out-of-the-box;</li>
<li>Import inventory data using a computer or smartphone;</li>
<li>Configure payment options (payment gateway, gift cards, shop credit, etc.);</li>
<li>Start selling online;</li>
</ol>
<p>Moreover, if they are small enough, they can get away doing it almost for free. I admit this is a long shot, but it can happen. Cloud providers such as Google Cloud, AWS, and Azure already provide some products that make this easier to achieve, such as <a href="https://cloud.google.com/functions/">Cloud Functions</a>.</p>
<p>Due to latency concerns, though, one day, they might decide to use a lightweight <a href="/posts/homelab">Intel NUC server</a> to run everything on-premises. For example, if they are opening up shop in a rocket flying to Mars. Thanks to the &rsquo;no strings attached&rsquo; concept of the public domain, they can do it without having to ask.</p>
<h2 id="a-few-more-points">A few more points</h2>
<ul>
<li>Seach Engine Optimization using techniques such as structured data to drive high conversion rates.</li>
<li>Freedom of payment gateway: it should be easy to integrate with the likes of PayPal, Square, Stripe, and so on. Or even no gateway.</li>
<li>Bye-bye vendor lock-in: if the solution is not for you, just take over.</li>
<li>Rely on Go simplicity to make it simple to write high-quality e-commerce software.</li>
<li>Follow the Go proverbs.</li>
<li>Safety first: third-party code and dependencies audited before usage.</li>
<li>Single sign-on is very interesting. So it is a traditional login. So is Multi-Factor Authentication (MFA). It is okay not to have everything from day one.</li>
</ul>

                <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-size="large"
                        data-text="I&#39;m starting an opensource e-commerce project." data-url="https://henvic.dev/posts/e-commerce/" data-via="henriquev"
                        data-hashtags="e-commerce,opensource,public domain,project"  data-show-count="false">Tweet</a>
                        <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
        <aside class="read-also">
                <h3>Read also</h3>
                <ul>
                        <li>
                                <a href="/posts/tesla/">My new Tesla Model Y 2023</a>
                                <time datetime="2006-01-02">Wednesday 11, January 2023</time>
                        </li><li>
                                <a href="/posts/go-utf8/">UTF-8 strings with Go: len(s) isn&#39;t enough</a>
                                <time datetime="2006-01-02">Monday 7, March 2022</time>
                        </li><li>
                                <a href="/posts/go-postgres/">Back to basics: Writing an application using Go and PostgreSQL</a>
                                <time datetime="2006-01-02">Monday 22, November 2021</time>
                        </li><li>
                                <a href="/posts/postgres-14-freebsd-13/">Upgrading to PostgreSQL 14 on FreeBSD 13</a>
                                <time datetime="2006-01-02">Thursday 11, November 2021</time>
                        </li><li>
                                <a href="/posts/uuid/">You don&#39;t need UUID</a>
                                <time datetime="2006-01-02">Sunday 30, May 2021</time>
                        </li><li>
                                <a href="/posts/go/">The ecosystem of the Go programming language</a>
                                <time datetime="2006-01-02">Monday 22, March 2021</time>
                        </li><li>
                                <a href="/posts/my-go-mistakes/">My Go mistakes</a>
                                <time datetime="2006-01-02">Thursday 18, February 2021</time>
                        </li><li>
                                <a href="/posts/env/">Environment variables, config, secrets, and globals</a>
                                <time datetime="2006-01-02">Saturday 16, January 2021</time>
                        </li><li>
                                <a href="/posts/signal-notify-context/">signal.NotifyContext: handling cancelation with Unix signals using context</a>
                                <time datetime="2006-01-02">Wednesday 16, September 2020</time>
                        </li><li>
                                <a href="/posts/cs-security/">Counter-Strike code leaked: should you worry? What if your code leaks? Learn how to deliver software securely.</a>
                                <time datetime="2006-01-02">Wednesday 22, April 2020</time>
                        </li>
                </ul>
        </aside>
</article>

            </div>
        </div>
    </div>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-43519325-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script src="/js/vendor/modernizr-custom-svg.js"></script>
<script src="/js/vendor/what-input.js"></script>
<script src="/js/vendor/jquery.min.js"></script>
<script src="/js/vendor/foundation.min.js"></script>
<script>
        $(document).ready(function () {
                $(document).foundation();
        });
</script>
</body>
</html>
